# Журнал Изменений (Интеграция Jira/Confluence)

Этот документ описывает основные изменения, внесенные в форк проекта `cursor-memory-bank` для реализации интеграции с Jira и Confluence с использованием инструментов MCP и гибкой конфигурации.

## Новые файлы

*   **`integration_config.md`**:
    *   Создан для централизованного хранения настроек интеграции.
    *   Содержит заглушки для ключа проекта Jira (`YOUR_JIRA_PROJECT_KEY`) и ключа пространства Confluence (`YOUR_CONFLUENCE_SPACE_KEY`).
    *   Включает тип задачи Jira по умолчанию (`Story`).
    *   Содержит сопоставление статусов Jira для каждого режима работы системы (PLAN, CREATIVE, VAN QA, IMPLEMENT, REFLECT, ARCHIVE).
    *   Включает инструкцию по настройке для пользователя.

## Измененные файлы

*   **`.cursor/rules/isolation_rules/visual-maps/plan-mode-map.mdc`**:
    *   Добавлен шаг чтения настроек из `integration_config.md`.
    *   Добавлена логика запроса у пользователя **существующих** компонентов и меток Jira.
    *   Добавлена полуавтономная логика работы с Эпиками:
        *   Запрос у пользователя, связана ли задача с Эпиком.
        *   Поиск существующих Эпиков по ключевым словам с помощью `mcp_mcp-atlassian_jira_search`.
        *   Предложение пользователю выбрать существующий Эпик, пропустить или создать новый.
        *   Создание нового Эпика при необходимости с помощью `mcp_mcp-atlassian_jira_create_issue`.
    *   Добавлен вызов `mcp_mcp-atlassian_jira_create_issue` для создания задачи (Story) с использованием данных из конфига, пользовательского ввода (компоненты, метки) и определенной связи с Эпиком.
    *   Добавлена логика записи полученного ID задачи Jira в файл `tasks.md` (в формате `[Jira: KEY-123]`).
    *   Добавлены примечания по обработке ошибок MCP (повторная попытка).

*   **`.cursor/rules/isolation_rules/visual-maps/creative-mode-map.mdc`**:
    *   Добавлен шаг чтения настроек из `integration_config.md` (статус Jira, ключ пространства Confluence).
    *   Добавлена логика чтения ID задачи Jira из `tasks.md`.
    *   Добавлен вызов `mcp_mcp-atlassian_jira_update_issue` для обновления статуса задачи Jira в соответствии с настройками.
    *   Добавлен вызов `mcp_mcp-atlassian_confluence_create_page` для создания страницы с дизайн-документацией в настроенном пространстве Confluence.
    *   Добавлены примечания по обработке ошибок MCP.

*   **`.cursor/rules/isolation_rules/visual-maps/qa-mode-map.mdc`**:
    *   Добавлен шаг чтения настроек из `integration_config.md` (статус Jira для успешной QA).
    *   Добавлена логика чтения ID задачи Jira из `tasks.md`.
    *   Добавлен вызов `mcp_mcp-atlassian_jira_update_issue` для обновления статуса задачи Jira при успешной валидации.
    *   Добавлены примечания по обработке ошибок MCP.

*   **`.cursor/rules/isolation_rules/visual-maps/reflect-mode-map.mdc`**:
    *   Добавлен шаг чтения настроек из `integration_config.md` (статус Jira для завершения рефлексии).
    *   Добавлена логика чтения ID задачи Jira из `tasks.md`.
    *   Добавлен вызов `mcp_mcp-atlassian_jira_update_issue` для обновления статуса задачи Jira.
    *   Добавлены примечания по обработке ошибок MCP.

*   **`.cursor/rules/isolation_rules/visual-maps/archive-mode-map.mdc`**:
    *   Добавлен шаг чтения настроек из `integration_config.md` (ключ пространства Confluence).
    *   Добавлена логика проверки/создания директории `docs/archive/`.
    *   Добавлена логика создания локального файла-сводки в `docs/archive/` с использованием ID задачи Jira.
    *   Добавлен вызов `mcp_mcp-atlassian_confluence_create_page` для создания/обновления страницы-сводки в настроенном пространстве Confluence.
    *   Обновлен проверочный список и финальное сообщение для отражения создания локального файла и страницы Confluence.
    *   Добавлены примечания по обработке ошибок MCP.

## Важные замечания

*   Перед использованием системы необходимо **настроить** файл `integration_config.md`, указав реальные ключи Jira и Confluence.
*   Для корректной работы шага сохранения локальной документации в режиме `ARCHIVE` убедитесь, что папка `docs/` существует в корне проекта или будет создана.
*   Были проблемы с сохранением изменений в `plan-mode-map.mdc`, была предпринята попытка повторного применения изменений. Рекомендуется проверить этот файл. 